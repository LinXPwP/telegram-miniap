<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <title>Telegram MiniApp â€“ Discord Style Chat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Telegram WebApp JS -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- ECRAN EROARE â€“ afiÈ™at dacÄƒ NU e context Telegram WebApp valid -->
  <div id="error-screen" class="error-screen">
    <div class="error-card">
      <div class="error-logo">TX</div>
      <h1>Acces mini-app</h1>
      <p>
        AceastÄƒ aplicaÈ›ie trebuie deschisÄƒ din Telegram folosind
        comanda <strong>/start</strong> Ã®n bot È™i apoi butonul de mini-app.
      </p>
      <ol>
        <li>Deschide Telegram.</li>
        <li>IntrÄƒ pe bot È™i scrie <code>/start</code>.</li>
        <li>ApasÄƒ pe butonul â€Deschide mini-appâ€.</li>
      </ol>
      <p class="error-foot">
        DacÄƒ vezi asta Ã®n browser simplu, accesul direct nu este permis.
      </p>
    </div>
  </div>

  <!-- APP ROOT â€“ se afiÈ™eazÄƒ doar cÃ¢nd contextul Telegram este valid -->
  <div id="app-root" class="hidden">
    <!-- Bara de sus -->
    <header class="top-bar">
      <div class="top-left">
        <div class="logo-circle">TX</div>
        <div class="top-title">
          <span class="top-title-main">Telegram MiniApp</span>
          <span class="top-title-sub">Discord Style â€¢ Black/Red â€¢ 2025</span>
        </div>
      </div>

      <div class="top-right">
        <!-- Desktop only â€“ controlat din JS -->
        <button id="open-full-btn" class="ghost-btn">
          ğŸ”— Versiune completÄƒ
        </button>

        <div id="current-user" class="user-pill">
          <div id="current-user-avatar" class="user-avatar user-avatar-sm"></div>
          <div class="user-info">
            <span id="current-user-name" class="user-name">@â€¦</span>
            <span id="current-user-tag" class="user-tag">Utilizator</span>
          </div>
        </div>
      </div>
    </header>

    <!-- TABBAR pentru MOBILE (ascuns pe desktop din CSS) -->
    <div class="mobile-tabbar">
      <button class="mobile-tab-btn active" data-panel="channels-panel">
        # Canale
      </button>
      <button class="mobile-tab-btn" data-panel="chat-panel">
        ğŸ’¬ Chat
      </button>
      <button class="mobile-tab-btn" data-panel="online-panel">
        ğŸ‘¥ Online
      </button>
    </div>

    <!-- Layout stil Discord: canale (stÃ¢nga), chat (mijloc), online (dreapta) -->
    <main class="layout">
      <!-- STÃ‚NGA â€“ CATEGORII + CANALE + PANOU ADMIN -->
      <section class="channels-panel" id="channels-panel">
        <div class="panel-header">
          <h2>Server</h2>
        </div>

        <div id="category-list" class="category-list">
          <!-- Populat din JS -->
        </div>

        <!-- Admin panel (vizibil doar pentru ADMIN_ID) -->
        <div class="admin-section" id="admin-panel">
          <div class="sidebar-title">
            Admin Panel
          </div>
          <div class="admin-controls">
            <input
              type="text"
              id="new-category-name"
              class="input"
              placeholder="Nume categorie"
            />
            <button id="create-category-btn" class="primary-btn">
              + Categorie
            </button>

            <input
              type="text"
              id="new-channel-name"
              class="input"
              placeholder="Nume canal (#general)"
            />
            <select id="category-select" class="input"></select>
            <button id="create-channel-btn" class="primary-btn">
              + Canal
            </button>
          </div>
        </div>
      </section>

      <!-- MIJLOC â€“ CHAT -->
      <section class="chat-panel" id="chat-panel">
        <div class="panel-header chat-header">
          <div class="chat-header-main">
            <span id="active-channel-name">#general</span>
            <span id="active-channel-category" class="chip">Default</span>
          </div>
          <div class="chat-header-sub">
            Istoric salvat local (demo) â€¢ Stil Discord
          </div>
        </div>

        <div id="chat-history" class="chat-history">
          <!-- Mesaje -->
        </div>

        <div class="chat-input-bar">
          <textarea
            id="chat-input"
            class="chat-input"
            rows="1"
            placeholder="Scrie un mesaj..."
          ></textarea>
          <button id="send-btn" class="primary-btn">
            Trimite
          </button>
        </div>
      </section>

      <!-- DREAPTA â€“ ONLINE -->
      <aside class="sidebar" id="online-panel">
        <div class="sidebar-section">
          <div class="sidebar-title">
            <span>Online</span>
            <span id="online-count" class="badge">0</span>
          </div>
          <div id="online-list" class="online-list">
            <!-- populat din JS -->
          </div>
        </div>
      </aside>
    </main>
  </div>

  <!-- mare atenÈ›ie la v=â€¦ pentru a forÈ›a Telegram sÄƒ ia versiunea nouÄƒ -->
  <script src="app.js?v=20"></script>
</body>
</html>
